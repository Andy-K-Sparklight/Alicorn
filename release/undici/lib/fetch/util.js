"use strict";const{redirectStatus}=require("./constants"),{performance}=require("perf_hooks"),{isBlobLike,toUSVString,ReadableStreamFrom}=require("../core/util");let File;const badPorts=["1","7","9","11","13","15","17","19","20","21","22","23","25","37","42","43","53","69","77","79","87","95","101","102","103","104","109","110","111","113","115","117","119","123","135","137","139","143","161","179","389","427","465","512","513","514","515","526","530","531","532","540","548","554","556","563","587","601","636","989","990","993","995","1719","1720","1723","2049","3659","4045","5060","5061","6000","6566","6665","6666","6667","6668","6669","6697","10080"];function responseURL(e){const r=e.urlList,t=r.length;return 0===t?null:r[t-1].toString()}function responseLocationURL(e,r){if(!redirectStatus.includes(e.status))return null;let t=e.headersList.get("location");return t=t?new URL(t,responseURL(e)):null,t&&!t.hash&&(t.hash=r),t}function requestCurrentURL(e){return e.urlList[e.urlList.length-1]}function requestBadPort(e){const r=requestCurrentURL(e);return/^http?s/.test(r.protocol)&&badPorts.includes(r.port)?"blocked":"allowed"}function isFileLike(e){return File||(File=require("./file").File),e instanceof File||e&&("function"==typeof e.stream||"function"==typeof e.arrayBuffer)&&/^(File)$/.test(e[Symbol.toStringTag])}function isValidReasonPhrase(e){for(let r=0;r<e.length;++r){const t=e.charCodeAt(r);if(!(9===t||t>=32&&t<=126||t>=128&&t<=255))return!1}return!0}function isTokenChar(e){return!(e>=127||e<=32||"("===e||")"===e||"<"===e||">"===e||"@"===e||","===e||";"===e||":"===e||"\\"===e||'"'===e||"/"===e||"["===e||"]"===e||"?"===e||"="===e||"{"===e||"}"===e)}function isValidHTTPToken(e){if(!e||"string"!=typeof e)return!1;for(let r=0;r<e.length;++r){const t=e.charCodeAt(r);if(t>127||!isTokenChar(t))return!1}return!0}function setRequestReferrerPolicyOnRedirect(e,r){}function crossOriginResourcePolicyCheck(){return"allowed"}function corsCheck(){return"success"}function TAOCheck(){return"success"}function appendFetchMetadata(e){let r=null;r=e.mode,e.headersList.append("sec-fetch-mode",r)}function appendRequestOriginHeader(e){let r=e.origin;if("cors"===e.responseTainting||"websocket"===e.mode)r&&e.headersList.append("Origin",r);else if("GET"!==e.method&&"HEAD"!==e.method){switch(e.referrerPolicy){case"no-referrer":r=null;break;case"no-referrer-when-downgrade":case"strict-origin":case"strict-origin-when-cross-origin":/^https:/.test(e.origin)&&!/^https:/.test(requestCurrentURL(e))&&(r=null);break;case"same-origin":e.origin!==requestCurrentURL(e).origin&&(r=null)}r&&e.headersList.append("Origin",r)}}function coarsenedSharedCurrentTime(e){return performance.now()}function makeTimingInfo(e){return{startTime:0,redirectStartTime:0,redirectEndTime:0,postRedirectStartTime:0,finalServiceWorkerStartTime:0,finalNetworkResponseStartTime:0,finalNetworkRequestStartTime:0,endTime:0,encodedBodySize:0,decodedBodySize:0,finalConnectionTimingInfo:null,...e}}function makePolicyContainer(){return{}}function clonePolicyContainer(){return{}}function determineRequestsReferrer(e){return"no-referrer"}function matchRequestIntegrity(e,r){return!1}function tryUpgradeRequestToAPotentiallyTrustworthyURL(e){}class ServiceWorkerGlobalScope{}class Window{}class EnvironmentSettingsObject{}module.exports={ServiceWorkerGlobalScope,Window,EnvironmentSettingsObject,ReadableStreamFrom,toUSVString,tryUpgradeRequestToAPotentiallyTrustworthyURL,coarsenedSharedCurrentTime,matchRequestIntegrity,determineRequestsReferrer,makePolicyContainer,clonePolicyContainer,appendFetchMetadata,appendRequestOriginHeader,TAOCheck,corsCheck,crossOriginResourcePolicyCheck,ReadableStreamFrom,makeTimingInfo,setRequestReferrerPolicyOnRedirect,isValidHTTPToken,requestBadPort,requestCurrentURL,responseURL,responseLocationURL,isBlobLike,isFileLike,isValidReasonPhrase};