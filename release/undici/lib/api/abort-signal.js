const{RequestAbortedError}=require("../core/errors"),kListener=Symbol("kListener"),kSignal=Symbol("kSignal");function abort(e){e.abort?e.abort():e.onError(new RequestAbortedError)}function addSignal(e,r){e[kSignal]=null,e[kListener]=null,r&&(r.aborted?abort(e):(e[kSignal]=r,e[kListener]=()=>{abort(e)},"addEventListener"in e[kSignal]?e[kSignal].addEventListener("abort",e[kListener]):e[kSignal].addListener("abort",e[kListener])))}function removeSignal(e){e[kSignal]&&("removeEventListener"in e[kSignal]?e[kSignal].removeEventListener("abort",e[kListener]):e[kSignal].removeListener("abort",e[kListener]),e[kSignal]=null,e[kListener]=null)}module.exports={addSignal,removeSignal};